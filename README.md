All base code is thanks to Spyros